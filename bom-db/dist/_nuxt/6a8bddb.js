(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{377:function(e,t,r){"use strict";r.r(t);r(46),r(22),r(93),r(94),r(45),r(33),r(157);var o=r(75),l=r.n(o),n=r(358),c={name:"GeneralBillsTable",components:{VueSlider:r.n(n).a},data:function(){return{errors:[],search:"",columns:[{label:"Parish",field:"name"},{label:"Count Type",field:"count_type"},{label:"Count",field:"count",type:"number"},{label:"Week Number",field:"week_no",type:"number"},{label:"Year",field:"year",type:"date",dateInputFormat:"yyyy",dateOutputFormat:"yyyy"},{label:"Split Year",field:"split_year"}],parishNames:[],filteredBillsData:[],totalParishes:[],totalRecords:0,countType:["Total","Plague","Buried"],filteredCountType:"Total",filteredParishIDs:[],filteredYears:[1640,1754],dotOptions:[{tooltip:"always"},{tooltip:"always"}],serverParams:{limit:25,offset:0,count_type:"Total",bill_type:"General",parishes:"",year:[1640,1754],perPage:25,page:1}}},computed:{filterParishNamesList:function(){var e=this;return this.parishNames.filter((function(t){return t.name.toLowerCase().includes(e.search.toLowerCase())}))}},mounted:function(){var e=this;l.a.get("https://data.chnm.org/bom/bills?start-year="+this.serverParams.year[0]+"&end-year="+this.serverParams.year[1]+"&bill-type="+this.serverParams.bill_type+"&count-type="+("All"===this.serverParams.count_type||"Total"===this.serverParams.count_type?"":this.serverParams.count_type)+(""===this.serverParams.parishes?"":"&parishes="+this.serverParams.parishes)+"&limit="+this.serverParams.limit+"&offset="+this.serverParams.offset).then((function(t){e.totalParishes=t.data})).catch((function(t){e.errors.push(t),console.log(e.errors)})),l.a.get("https://data.chnm.org/bom/parishes").then((function(t){e.parishNames=t.data})).catch((function(t){e.errors.push(t),console.log(e.errors)})),l.a.get("https://data.chnm.org/bom/totalbills?type=General").then((function(t){e.totalRecords=t.data[0].total_records})).catch((function(t){e.errors.push(t),console.log(e.errors)}))},methods:{onRowClick:function(e){console.log("row clicked",e)},updateParams:function(e){this.serverParams=Object.assign({},this.serverParams,e)},onPageChange:function(e){this.updateParams({page:e.currentPage,offset:(e.currentPage-1)*e.currentPerPage}),this.loadItems()},onPerPageChange:function(e){this.updateParams({perPage:e.currentPerPage}),this.loadItems()},loadItems:function(){var e=this;return l.a.get("https://data.chnm.org/bom/bills?start-year="+this.serverParams.year[0]+"&end-year="+this.serverParams.year[1]+"&bill-type="+this.serverParams.bill_type+("All"===this.serverParams.count_type||"Total"===this.serverParams.count_type?"":"&count-type="+this.serverParams.count_type)+(""===this.serverParams.parishes?"":"&parishes="+this.serverParams.parishes)+"&limit="+this.serverParams.limit+"&offset="+this.serverParams.offset).then((function(t){e.totalParishes=t.data})).catch((function(t){e.errors.push(t),console.log(e.errors)}))},updateFilteredYearsArray:function(e){this.filteredYears=e,console.log(e),this.updateParams({year:e})},updateFilteredCountType:function(e){this.updateParams({count_type:e.target.value})},applyFilters:function(){this.updateParams({parishes:this.filteredParishIDs,year:this.filteredYears,count_type:this.filteredCountType}),this.loadItems()},resetFilters:function(){this.filteredParishIDs=[],this.filteredYears=[1640,1754],this.filteredCountType="Total",this.search="",this.updateParams({parishes:[],count_type:"Total",year:[1640,1754]}),this.loadItems()}}},d=r(60),component=Object(d.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"accordion",attrs:{id:"filters"}},[r("div",{staticClass:"filter-item bg-white border border-gray-200 rounded-none"},[e._m(0),e._v(" "),r("div",{staticClass:"accordion-collapse collapse show",attrs:{id:"collapseOne","aria-labelledby":"headingOne","data-bs-parent":"#accordionFilters"}},[r("div",{staticClass:"accordion-body py-4 px-5"},[r("div",{staticClass:"grid grid-cols-4 gap-4 pb-6"},[r("div",{staticClass:"overflow-y-auto h-48 px-4 py-4"},[r("div",{staticClass:"accordion accordion-flush border-2 border-slate-300",attrs:{id:"accordionParishes"}},[r("div",{staticClass:"accordion-item rounded-none"},[e._m(1),e._v(" "),r("div",{staticClass:"accordion-collapse border-0 collapse show",attrs:{id:"flush-collapseOne","aria-labelledby":"flush-headingOne","data-bs-parent":"#accordion"}},[r("div",{staticClass:"accordion-body py-4 px-5"},[r("div",{staticClass:"py-3",attrs:{id:"search-wrapper"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",attrs:{type:"text",placeholder:"Search parishes"},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}})]),e._v(" "),r("ul",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"parish-selection-menu"}},e._l(e.filterParishNamesList,(function(t,o){return r("li",{key:o},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.filteredParishIDs,expression:"filteredParishIDs"}],staticClass:"dropdown-item",attrs:{id:t.canonical_name,name:"parish",type:"checkbox"},domProps:{value:t.id,checked:Array.isArray(e.filteredParishIDs)?e._i(e.filteredParishIDs,t.id)>-1:e.filteredParishIDs},on:{change:function(r){var o=e.filteredParishIDs,l=r.target,n=!!l.checked;if(Array.isArray(o)){var c=t.id,d=e._i(o,c);l.checked?d<0&&(e.filteredParishIDs=o.concat([c])):d>-1&&(e.filteredParishIDs=o.slice(0,d).concat(o.slice(d+1)))}else e.filteredParishIDs=n}}}),e._v(" "),r("label",{attrs:{for:t.canonical_name}},[r("span",[e._v(e._s(t.canonical_name))])])])})),0)])])])])]),e._v(" "),r("div",{staticClass:"overflow-y-auto h-48 px-4 py-4"},[r("div",{staticClass:"accordion accordion-flush border-2 border-slate-300",attrs:{id:"accordionYears"}},[r("div",{staticClass:"accordion-item rounded-none"},[e._m(2),e._v(" "),r("div",{staticClass:"accordion-collapse border-0 collapse show h-24",attrs:{id:"flush-collapseYear","aria-labelledby":"flush-headingOne","data-bs-parent":"#accordion"}},[r("div",{staticClass:"accordion-body py-4 px-5"},[r("div",{staticClass:"slider-container"},[r("vue-slider",{attrs:{min:1640,max:1754,interval:1,"enable-cross":!1,lazy:!0,"dot-options":e.dotOptions},on:{change:e.updateFilteredYearsArray},model:{value:e.filteredYears,callback:function(t){e.filteredYears=t},expression:"filteredYears"}})],1)])])])])]),e._v(" "),r("div",{staticClass:"overflow-y-auto h-48 px-4 py-4"},[r("div",{staticClass:"accordion accordion-flush border-2 border-slate-300",attrs:{id:"accordionCount"}},[r("div",{staticClass:"accordion-item rounded-none"},[e._m(3),e._v(" "),r("div",{staticClass:"accordion-collapse border-0 collapse show h-24",attrs:{id:"flush-collapseCount","aria-labelledby":"flush-headingOne","data-bs-parent":"#accordion"}},[r("div",{staticClass:"accordion-body py-4 px-5"},[r("div",{staticClass:"dropdown relative"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.filteredCountType,expression:"filteredCountType"}],staticClass:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",attrs:{"arias-expanded":"false"},on:{change:[function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.filteredCountType=t.target.multiple?r:r[0]},function(t){return e.updateFilteredCountType(t)}]}},e._l(e.countType,(function(t,o){return r("option",{key:o,staticClass:"dropdown-menu min-w-max text-base float-left",domProps:{value:t}},[e._v("\n                            "+e._s(t)+"\n                          ")])})),0)])])])])])]),e._v(" "),r("div",{staticClass:"overflow-y-auto h-48 px-4 py-4"},[r("button",{staticClass:"text-xs font-bold uppercase px-5 py-3 m-0.5 w-40 rounded block leading-normal border-solid border-2 border-dbn-yellow text-white bg-dbn-yellow hover:bg-dbn-yellowdark",on:{click:e.resetFilters}},[e._v("\n                Reset Filters\n              ")]),e._v(" "),r("button",{staticClass:"text-xs font-bold uppercase px-5 py-3 m-0.5 w-40 rounded block leading-normal border-solid border-2 border-dbn-yellow text-white bg-dbn-yellow hover:bg-dbn-yellowdark",on:{click:function(t){return e.applyFilters()}}},[e._v("\n                Apply Filters\n              ")])])])])])])]),e._v(" "),r("vue-good-table",{attrs:{mode:"remote",columns:e.columns,rows:e.totalParishes,"total-rows":e.totalRecords,"max-height":"600px","fixed-header":!0,"pagination-options":{enabled:!0,position:"bottom",perPageDropdown:[25,50,100],dropdownAllowAll:!1,firstLabel:"First page",lastLable:"Last page",nextLabel:"Next page",previousLabel:"Previous page",rowsPerPageLabel:"Bills per page"},"sort-options":{enabled:!1},"search-options":{enabled:!1},"style-class":"vgt-table condensed striped"},on:{"on-page-change":e.onPageChange,"on-row-click":e.onRowClick,"on-per-page-change":e.onPerPageChange},scopedSlots:e._u([{key:"table-column",fn:function(t){return["Parish"==t.column.label?r("span",[r("span",{staticClass:"hint--top",attrs:{"aria-label":"The names of the parishes."}},[e._v("\n          "+e._s(t.column.label)+"\n        ")])]):"Count Type"==t.column.label?r("span",[r("span",{staticClass:"hint--top",attrs:{"aria-label":"The count type, either by the number in the parish with plague or the number buried in the parish."}},[e._v("\n          "+e._s(t.column.label)+"\n        ")])]):"Count"==t.column.label?r("span",[r("span",{staticClass:"hint--top",attrs:{"aria-label":"The number of plague or buried in the parish."}},[e._v("\n          "+e._s(t.column.label)+"\n        ")])]):"Week Number"==t.column.label?r("span",[r("span",{staticClass:"hint--top",attrs:{"aria-label":"The week number in the year."}},[e._v("\n          "+e._s(t.column.label)+"\n        ")])]):"Year"==t.column.label?r("span",[r("span",{staticClass:"hint--top",attrs:{"aria-label":"The year for the data."}},[e._v("\n          "+e._s(t.column.label)+"\n        ")])]):"Split Year"==t.column.label?r("span",[r("span",{staticClass:"hint--top",attrs:{"aria-label":"The split year for the data."}},[e._v("\n          "+e._s(t.column.label)+"\n        ")])]):r("span",[e._v("\n        "+e._s(t.column.label)+"\n      ")])]}}])})],1)}),[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("h2",{staticClass:"accordion-header mb-0",attrs:{id:"headingOne"}},[r("button",{staticClass:"accordion-button relative flex items-center w-full py-4 px-5 text-base text-dbn-purple text-left bg-white border-0 rounded-none transition focus:outline-none",attrs:{type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseOne","aria-expanded":"true","aria-controls":"collapseOne"}},[e._v("\n          Filter By\n        ")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("h2",{staticClass:"accordion-header mb-0",attrs:{id:"parish-headingOne"}},[r("button",{staticClass:"accordion-button collapsed relative flex items-center w-full py-4 px-5 text-base text-gray-800 text-left bg-white border-0 rounded-none transition focus:outline-none",attrs:{type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseOne","aria-expanded":"false","aria-controls":"flush-collapseOne"}},[e._v("\n                      Parishes\n                    ")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("h2",{staticClass:"accordion-header mb-0",attrs:{id:"years-headingOne"}},[r("button",{staticClass:"accordion-button collapsed relative flex items-center w-full py-4 px-5 text-base text-gray-800 text-left bg-white border-0 rounded-none transition focus:outline-none",attrs:{type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseYear","aria-expanded":"false","aria-controls":"flush-collapseYear"}},[e._v("\n                      Year Range\n                    ")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("h2",{staticClass:"accordion-header mb-0",attrs:{id:"count-headingOne"}},[r("button",{staticClass:"accordion-button collapsed relative flex items-center w-full py-4 px-5 text-base text-gray-800 text-left bg-white border-0 rounded-none transition focus:outline-none",attrs:{type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseCount","aria-expanded":"false","aria-controls":"flush-collapseCount"}},[e._v("\n                      Count Type\n                    ")])])}],!1,null,null,null);t.default=component.exports}}]);